<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I DECIDED - Admin Dashboard</title>    
    <!-- Add Decap CMS script -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    
     <style>
        /* Remove all custom styles except this */
        #nc-root {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
    </style>
</head>
<body>
    <!-- Only include the mount point - no wrappers -->
    <div id="nc-root"></div>

    <!-- Authentication Check -->
    <script>
        // Check authentication
        if(!localStorage.getItem('admin-authenticated')) {
            localStorage.setItem('cms-redirect', window.location.href);
            window.location.href = 'login.html';
        }
        
        // Auto-logout after 30 minutes
        setTimeout(() => {
            localStorage.removeItem('admin-authenticated');
            window.location.href = 'login.html';
        }, 30 * 60 * 1000);
    </script>

    <!-- Load CMS Script - IMPORTANT: Load only once! -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    
    <!-- Simplified CMS Initialization -->
    <script>
        // Initialize CMS directly without wrapper functions
        if (typeof CMS !== 'undefined') {
            CMS.init({ 
                config: "config.yml" 
            });
        } else {
            const errorDiv = document.createElement('div');
            errorDiv.innerHTML = `
                <div style="padding: 2rem; text-align: center;">
                    <h2>CMS Failed to Load</h2>
                    <p>Please refresh the page or check your connection</p>
                    <button onclick="window.location.reload()" 
                            style="padding: 10px 20px; background: #37a7c2; color: white; border: none; cursor: pointer;">
                        Reload CMS
                    </button>
                </div>
            `;
            document.getElementById('nc-root').appendChild(errorDiv);
        }
    </script>
</body>
</html>