<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Content Manager</title>
    <script>
        // Authentication check
        if (!localStorage.getItem('admin-authenticated')) {
            localStorage.setItem('cms-redirect', window.location.href);
            window.location.href = 'login.html';
        }
        
        // Auto-logout
        setTimeout(() => {
            localStorage.removeItem('admin-authenticated');
            window.location.href = 'login.html';
        }, 30 * 60 * 1000);
    </script>
</head>
<body>
    <!-- Only this element - no wrappers, no styles -->
    <div id="nc-root"></div>

    <!-- Load CMS script first -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    
    <script>
        // Add this message listener
        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'auth-log') {
                console.log('[AUTH-LOG]', event.data.message);
            }
        });
        
        // Minimal initialization
        if (typeof CMS !== 'undefined') {
            console.log('CMS loaded, initializing...');
            CMS.init({ config: "config.yml" });
        } else {
            console.error('CMS not loaded');
            document.getElementById('nc-root').innerHTML = `
                <div style="padding: 20px; text-align: center;">
                    <h2>CMS Failed to Load</h2>
                    <button onclick="window.location.reload()">Reload</button>
                </div>
            `;
        }
    </script>
</body>
</html>