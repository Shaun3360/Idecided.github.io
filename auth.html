<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Auth Redirect</title>
  <script>
    window.addEventListener('load', function() {
      // Extract token from URL
      const tokenMatch = window.location.href.match(/access_token=([^&]+)/);
      if (tokenMatch && tokenMatch[1]) {
        const token = tokenMatch[1];
        
        // Send token to parent window
        window.opener.postMessage({
          type: 'authorization',
          data: {
            token: token,
            provider: 'github'
          }
        }, window.location.origin);
        
        // Confirm receipt before closing
        const confirmInterval = setInterval(() => {
          if (window.opener.closed) {
            clearInterval(confirmInterval);
            window.close();
          }
        }, 300);
        
        // Fallback close after 3 seconds
        setTimeout(() => {
          window.close();
        }, 3000);
      } else {
        console.error('Token not found in URL');
        window.close();
      }
    });
  </script>
</head>
<body>
  <div style="text-align: center; padding: 50px; font-family: sans-serif;">
    <h2>Authentication Successful</h2>
    <p>This window will close automatically</p>
    <p><small>If it doesn't close, you may manually close this window</small></p>
  </div>
</body>
</html>